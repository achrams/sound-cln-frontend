import{_ as f,S as w,c as d,a as e,e as b,r as v,w as _,f as D,F as x,g as p,h as y,d as m,o as i,t as l}from"./index-jWITr_ym.js";import{u as g,w as k}from"./xlsx-D1NZSDnX.js";const E={components:{SideBar:w},name:"LaporanTahunan",data(){return{selectedYear:"",years:[2025,2024,2023,2022,2021],laporan:[]}},computed:{filteredLaporan(){return this.laporan.filter(s=>new Date(s.createdAt).getFullYear()===this.selectedYear)}},methods:{async fetchData(){try{const s=await m.get("http://localhost:40001/income"),t=await m.get("http://localhost:40001/expenses");s.data.forEach(o=>o.transaction_type="Pemasukan"),t.data.forEach(o=>o.transaction_type="Pengeluaran");const r=[...s.data,...t.data];r.sort((o,n)=>new Date(o.tanggal)-new Date(n.tanggal)),this.laporan=r,console.log("Laporan fetched successfully:",this.laporan)}catch(s){console.error("Error fetching data:",s)}},downloadFile(){const s=this.filteredLaporan.map((o,n)=>({No:n+1,"Tanggal Transaksi":this.formatDate(o.createdAt),"Tipe Transaksi":o.transaction_type,Nominal:o.total,"Nama Pemesan":o.name,Keterangan:o.description})),t=g.json_to_sheet(s),r=g.book_new();g.book_append_sheet(r,t,"Laporan Tahunan"),k(r,`laporan_${this.selectedYear}.xlsx`)},formatDate(s){const t={year:"numeric",month:"long",day:"numeric"};return new Date(s).toLocaleDateString("id-ID",t)}},created(){localStorage.getItem("token")===null&&this.$router.push("/login");const s=new Date().getFullYear();this.selectedYear=s,this.fetchData()}},T={class:"min-h-screen flex bg-gray-50"},B={class:"flex flex-col items-center p-5 bg-gray-100 w-full"},L={class:"flex justify-center gap-4 mb-6"},S=["value"],F={class:"w-full rounded-t-lg shadow-md shadow-gray-700 bg-none mb-12"},N={class:"p-2 bg-[#D1D5DB] text-xs md:text-lg w-1/12"},Y={class:"p-2 bg-[#E5E7EB] text-xs md:text-lg w-2/12"},j={class:"p-2 bg-[#D1D5DB] text-xs md:text-lg w-2/12"},A={class:"p-2 bg-[#E5E7EB] text-xs md:text-lg w-2/12"},P={class:"p-2 bg-[#D1D5DB] text-xs md:text-lg w-2/12"},V={class:"p-2 bg-[#E5E7EB] text-xs md:text-lg w-3/12"},C={class:"flex justify-center mt-6"};function I(s,t,r,o,n,c){const u=v("SideBar");return i(),d(x,null,[e("div",T,[b(u),e("div",B,[t[3]||(t[3]=e("div",{class:"flex justify-center items-center mb-6"},[e("h2",{class:"text-3xl font-bold text-[#6d1b23]"},"Laporan Tahunan")],-1)),e("div",L,[_(e("select",{"onUpdate:modelValue":t[0]||(t[0]=a=>n.selectedYear=a),class:"p-3 border border-[#6d1b23] rounded-lg shadow-sm bg-white text-black-800 font-bold"},[(i(!0),d(x,null,p(n.years,a=>(i(),d("option",{key:a,value:a},l(a),9,S))),128))],512),[[D,n.selectedYear]])]),t[4]||(t[4]=e("div",{class:"flex justify-between items-center mt-4"},[e("h2",{class:"text-2xl font-bold mb-3"},"List Laporan Tahunan")],-1)),e("div",F,[t[2]||(t[2]=y('<div class="rounded-t-lg"><div class="bg-[#6d1b23] text-white flex text-left md:text-center rounded-t-lg"><div class="p-2 text-xs md:text-lg w-1/12">No.</div><div class="p-2 text-xs md:text-lg w-2/12">Tanggal Transaksi</div><div class="p-2 text-xs md:text-lg w-2/12">Tipe Transaksi</div><div class="p-2 text-xs md:text-lg w-2/12">Nominal</div><div class="p-2 text-xs md:text-lg w-2/12">Nama Pemesan</div><div class="p-2 text-xs md:text-lg w-2/12">Keterangan</div></div></div>',1)),e("div",null,[(i(!0),d(x,null,p(c.filteredLaporan,(a,h)=>(i(),d("div",{class:"text-left md:text-center flex border-b-1 border-gray-400",key:a.id},[e("div",N,l(h+1),1),e("div",Y,l(c.formatDate(a.createdAt)),1),e("div",j,l(a.transaction_type),1),e("div",A,l(a.total),1),e("div",P,l(a.name),1),e("div",V,l(a.description),1)]))),128))])]),e("div",C,[e("button",{onClick:t[1]||(t[1]=(...a)=>c.downloadFile&&c.downloadFile(...a)),class:"px-4 py-2 bg-green-600 text-white font-bold rounded-lg hover:bg-green-700"}," Download File ")])])]),t[5]||(t[5]=e("footer",{class:"text-center py-3 bg-[#6d1b23] text-white w-full bottom-0 z-10"}," Â© All Rights Reserved. ",-1))],64)}const z=f(E,[["render",I]]);export{z as default};
